摘要：

[TOC]

## 1. introduction

### 1.1 Problem Statement

在美国的部分地区，滥用合成和非合成类阿片形成了一种新的社会危机，且该滥用行为已经呈现出从本地向周围扩散的趋势。阿片类药物对处于不同阶层，不同年龄段的人群均会产生影响，如果阿片类药物的成瘾人数持续上升，长此以往，社会的发展将受到极大的影响。

In some parts of the United States, the abuse of synthetic and non-synthetic opioids has formed a new social crisis, and this abuse has shown a trend of spreading from local to periphery. Opioids have an impact on people of different levels and different age groups. If the number of opioid addicts continues to rise, the development of society will be greatly affected in the long run.  

NFLIS发布了一份来自犯罪实验室涉及各州的年度数据报告，这份报告中含有美国俄亥俄州、肯塔基州、西弗吉尼亚州、弗吉尼亚州和田纳西州各个县的药物使用信息以及该地区经济、人口年龄分布等数据。在此基础上，还可以自行收集五个州的各个县的具体地理坐标来增加可用数据的数目。

The NFLIS publishes an annual data report which covers every state from the crime lab. The report contains information on drug use in Ohio, Kentucky, West Virginia, Virginia and Tennessee counties, as well as data on the region's economy and population age distribution. On this basis, you can also collect the specific geographic coordinates of each county in the five states to increase the number of available data.

对于第 1 部分的问题，我们需要根据已提供的数据建立合适的模型，找出阿片类药物的扩散源头，阿片类药物的扩散趋势，阿片类药物的阈值以及预测阿片类药物未来的变动。

For the first part of the question, we need to create an appropriate model based on the data provided to find out the source of opioid diffusion , the spread trend of opioids , the threshold of opioids and predict the future changes in opioids.  

对于第 2 部分的问题，我们需要从给出的州县的社会经济数据中得到额外的信息，来对模型进行相应的改进使得到的结果更加准确。

For the problem in Part 2, we need to get additional information from the socioeconomic data of the given states and counties to make corresponding improvements to the model to make the results more accurate.

对于第 3 部分的问题，我们需要针对美国国策，提出有效针对阿片类药物的抑制策略，并且测试策略的有效性。

 For part 3, we need to propose an effective strategy for opioid suppression and test the effectiveness of the strategy for U.S. Policy. 

### 1.2 Analysis and Approach Overview 

#### 1.2.1 Total Analysis

由分析可知：

From the analysis, it can be seen that:  

州内部的合成类阿片是通过具有相邻关系的县进行向外扩散的，那么就可以判定州之内的县与县之间的合成类阿片的数量变动是彼此相互影响的，所以我们在构造数学模型时就不可排除独立的个体(县与县)之间的相互影响；

Synthetic opioids within the state are spread out through counties with neighboring relationships, so it can be determined that the number of synthetic opioids between counties and counties within the state interacts with each other, therefore, when we construct the mathematical model, we can not exclude the interaction between independent individuals (counties and counties);  

州之间的合成类阿片是通过集成度较高的州往周围集成度较低的州扩散的，那么就可以判定州与州之间的合成类阿片的数量变动是受一个中心体影响的。

Synthetic opioids between states are spread through a more integrated state to a less integrated state, so it can be determined that changes in the number of synthetic opioids between states are affected by a centrosome.  

综上分析，我们类比合成类阿片的传播过程与SARS病毒的传播过程，选择使用 SIS 传播动力学模型作为贯穿整个建模过程的主线结合使用BP神经网络，熵权法，灰色关联分析法，对传统的 SIS 模型进行改进，完成建模与优化。

In summary, we compare the propagation process of synthetic opioids with the propagation process of SARS virus, and choose to use SIS propagation dynamics model as the main line throughout the modeling process using BP neural network, entropy weight method, gray correlation analysis method. Finally , the traditional SIS model is improved to complete modeling and optimization.

#### 1.2.2 First Part

我们设定了一个指标$$H$$，将其定义为$$H = 权重1·合成类阿片本年度的数量 + 权重2· 合成类阿片本年度数量的变化率$$

通过观测$$H$$ 的变动趋势来间接表现出合成类阿片的扩散趋势，比如：当该$$H$$的大小处于上升阶段时，可以得知该地区正在受到扩散的影响；当$$H$$的大小变化不大时，且数值较小时，则该地区没有受到扩散的影响；当该$$H$$的大小变化不大时，且数值较大时，则该地区已经被扩散影响并且处于合成类阿片被滥用的情况。同时借助某地区的区位信息(经纬度)，我们将计算结果投影到地图上反映出这一变化趋势，客观显示出运算结果。

推测其扩散的源头，我们通过BP神经网络，将时间顺序反过来作为自变量带入模型中进行计算。当大部分县的H值较小且H增长率较小，但是有某些县的H值较小但H增长率较大时，则可以得出这些地区即为起源点。

关于阈值的定义以及预测将会在何时何地发生，我们用特定的指标H来衡量什么时候政府需要对该地区进行管控。通过BP神经网络来对2010-2017的数据进行拟合，进而预测2018年以及之后的毒品扩散情形，进而预测在何时何地达到阈值从而需要政府进行管制。

#### 1.2.2 第二部分的问题

关于判断社会经济数据的哪项因素影响扩散的趋势，我们通过灰色关联分析法从已知的政治经济数据中筛选出对合成和非合成类阿片扩散影响较大的因素，并且同时求出各个因素影响的权重。进而将这些影响较大的因素放入SIS模型中，再通过BP神经网络预测2018年以及之后事件扩散的情形，并得出是哪些人在滥用药物，是什么导致了药物使用和成瘾的增长的结论。

## 2.assumptions

为了简化模型，我们不考虑各个州与县之间的人口迁入迁出，以及人口的出生和死亡对合成类阿片和海洛因事件的扩散造成的影响。所有邻接县之间的毒品事件的传播能力相同，各个县的治理能力相同，不考虑临县之间邻接面积对传播能力的影响。并且该县关于毒品的总事件数量分为已发生的毒品事件和潜在毒品事件。

## 3.模型中的符号

已发生毒品事件的占比为 $$I​$$

潜在的毒品事件占比为 $$S$$

I的增长率 $$F​$$

单位事件传播概率为 $$β$$

单位时间（年）内的治理概率为 $$Υ​$$

衡量该地区合成和非合成类阿片事件扩散的严重程度的指标 $$H​$$

$$H$$中$$I$$对应的权重 $$a1$$

$$H$$中$$I$$对应的权重 $$a2​$$

$$H$$的增长率 $$h$$

---

熵权法指标的信息熵 $$T_j$$

熵权法计算信息熵的中间变量 $$P_{ij}$$

熵权法各指标权重 $$M$$

------

BP神经网络的输入 $$X$$

BP神经网络的输出 $$Y$$

BP神经网络从 $$l-1 $$ 层第  $$j$$  个神经元与  $$l$$  层第  $$i$$  个神经元之间的连接权重 $$W_{ij}$$

BP神经网络第 $$ l$$  层第 $$i$$ 个神经元的偏置 $$b_{i}^{(l)}$$ 

BP神经网络 $$  l  $$  层第  $$i$$   个神经元的输入 $$net^{(l)}_i$$

BP神经网络单个样本的训练误差 $$E(i)$$

------

灰色关联分析法参考数据列 $$X_0^{‘}$$

灰色关联分析法指标序列 $$|x_0(k)-x_i(k)|$$

灰色关联分析法指标序列最大值$$\min\limits_{i=1}^{n}\min\limits_{k=1}^{m}  {|x_0(k)-x_i(k)|}$$

灰色关联分析法指标序列最小值$$\max\limits_{i=1}^{n} \max\limits_{k=1}^{m} {|x_0(k)-x_i(k)|}$$

灰色关联分析法的关联系数 $$ζ_i(k)$$ 

灰色关联分析法的关联序列 $$r_{0i} $$

灰色关联分析法加权平均的关联序列$$r^{'}_{0i}$$

---

## 4.模型

### 4.1 建立整体模型用到的各个模型

#### 4.1.1 熵权法求衡量扩散严重程度的指标H

我们设定了H为合成和非合成类阿片事件和其增加率分别乘上各自的权重，再求和。

也即：
$$
H = a_1·I+ a_2 ·F
$$
熵权法的基本思路是根据指标变异性的大小来确定客观权重，一般来说，若某个指标的信息熵E_j越小，表明指标值的变异程度越大，提供的信息量越多，在综合评价中所能起到的作用也越大，其权重也就越大。相反，某个指标的信息熵$$E_j​$$越大，表明指标值得变异程度越小，提供的信息量也越少，在综合评价中所起到的作用也越小，其权重也就越小。则我们借助该方法来求出权值a1,a2。

4.1.1.1数据标准化

我们先将各个指标的数据进行标准化处理。假设给定了$$K$$个指标$$X_1,X_2,....X_K$$,其中$$X_i = {x_i,x_2,....x_n}$$。假设对各指标数据标准化后的值为$$Y_1,Y_2,.....Y_k$$,那么$$Y_{ij} = \frac{X_{ij}-min(X_i)}{max(X_i)-max(X_j)} $$

4.1.1.2求各指标的信息熵

数据的信息熵为：

$$T_j = -ln(n)^{-1} \sum \limits_{i=1}^{N}P_{ij}lnp_{ij}$$ 

其中$$P_{ij}= \frac{Y_{ij}}{\sum\limits_{i=1}^{n}Y_{ij}}$$

如果$$P_{ij}=0$$，则定义$${\lim\limits_{P_{ij} \to +0}}P_{ij}lnp_{ij}=0$$ 

4.1.1.3确定各指标权重

根据信息熵的计算公式，计算出各个指标的信息熵为$$T_1,T_2,......T_K$$ 。通过信息熵计算各指标的权重为：

​                                                                         $$M = \frac{1-T_I}{k-\sum{T_i}}(i=1,2)$$ 

综上我们可以求得二者的权重$$a1​$$,$$a2​$$。

### 4.1.2 改进的SIS模型

参考SIS模型，我们对该模型进行改进以适应该问题。相关假设已述，则该模型如下图所示：

![2](C:\Users\WYX\Desktop\2.png)



根据以上模型可得：
$$
\frac{dI}{dt} =I·(β·S-Υ)\\
\frac{dS}{dt} =-I·(β·S-Υ)
$$
则当$$β·S-Υ>0​$$时，事件的发生数量开始增长，作为衡量$$H​$$大小的一部分。

(由之前分析，我们已知H足够大时，则说明该地区毒品事件数目较多并且增长率较大，扩散情况较严重，政府应当对该地区实施相关措施以遏制毒品事件的发生。)

### 4.1.3 BP神经网络

BP神经网络算法是一种最有效的多层神经网络学习方法，其主要特点是信号前向传递，而误差后向传播，通过不断调节网络权重值，使得网络的最终输出与期望输出尽可能接近，以达到训练的目的。 

BP神经网络图示为：

![1](C:\Users\DELL\Desktop\1.png)

#### 4.1.3.1 运算过程

令输入向量为：
$$
X = [x_1,x_2,…x_i…x_m],i=1,2,…,m
$$
输出向量：
$$
Y =[y_1,y_2,…y_k…y_n],k=1,2,…,n
$$
第 $$ i $$ 层各神经元输出为：
$$
h^{(l)}=[h_{1}^{(l)},h_{2}^{(l)}…h_{j}^{(l)}…h_{s}^{(sl)}],j=1,2,…,sl
$$
$$ sl $$为第 $$l$$ 层神经元数目 

设 $$W_{ij}^{i}$$为从 $$l-1 $$ 层第  $$j$$  个神经元与  $$l$$  层第  $$i$$  个神经元之间的连接权重；$$b_{i}^{(l)}$$ 为第 $$ l$$  层第 $$i$$ 个神经元的偏置，那么
$$
h_{i}^{(l)} = f(net_i^{(l)})\\
net_i^{(l)} = \sum_{j=1}^{sl-1}W_{ij}^{(l)}h_j^{(l-1)} + b_i^{(l)}
$$
其中，$$net^{(l)}_i$$为  $$  l  $$  层第  $$i$$   个神经元的输入，$$f(⋅)  $$  为神经元的激活函数。通常在多层神经网络中采用非线性激活函数，而不是用\\线性激活函数，因为采用基于线性激活函数的多层神经网络本质上还是多个线性函数的叠加，其结果仍然为一个线性函数。

#### 4.1.3.2 激活函数

BP神经网络使用的非线性激活函数：
$$
f(x) = \frac 1 {1 + e^{-x}}\\
f(x) = \frac {1 - e^{-x}} {1 + e^{-x}}
$$

#### 4.1.3.3 BP算法

给定$$m$$个训练样本，误差函数为：
$$
E = \frac 1 m \sum_{i=1}^m E(i)
$$
其中，$$E(i)$$为单个样本的训练误差： 
$$
E(i) = \frac 1 2 \sum_{k=1}^n (d_k(i) - y_k(i))^2
$$
因此，
$$
E = \frac 1 {2m} \sum_{i=1}^m \sum_{k=1}^n (d_k(i) - y_k(i))^2
$$
BP算法每一次迭代按照以下方式对权值以及偏置进行更新： 
$$
W_{ij}^{(l)} = W_{ij}^{(l)} -\alpha \frac {\partial E} {\partial W_{ij}^{(l)}}\\
b_i^{(l)} = b_i^{(l)} -\alpha \frac {\partial E} {\partial b_i^{(l)}}
$$
 其中，$$α​$$为学习速率，它的取值范围为(0, 1)。 

### 4.1.4 灰色关联分析法

灰色关联分析是指对一个系统发展变化态势的定量描述和比较的方法，其基本思想是通过确定参考数据列和若干个比较数据列的几何形状相似程度来判断其联系是否紧密，它反映了曲线间的关联程度。

通常可以运用此方法来分析各个因素对于结果的影响程度，也可以运用此方法解决随时间变化的综合评价类问题，其核心是按照一定规则确立随时间变化的母序列，把各个评估对象随时间的变化作为子序列，求各个子序列与母序列的相关程度，依照相关性大小得出结论。

4.1.4.1 确定分析指标体系

设n个数据序列形成如下矩阵：
$$
(X^{'}_1,X^{'}_2,.....,X^{'}_n)=\left[
 \begin{matrix}
   x^{'}_1(1) & x^{'}_2(1)&..... &  x^{'}_n(1) \\
   x^{'}_1(2) & x^{'}_2(2)&..... &  x^{'}_n(2) \\
   .... & ..... &..... &  ..... \\
   x^{'}_1(m) & x^{'}_2(m)&..... &  x^{'}_n(m) \\
  \end{matrix}
  \right] \tag{3}
$$
其中m为指标的个数， $$X_i^{'}=  (x^{'}_i(1) , x^{'}_i(2),.....  ,x^{'}_i(m))^T，i=1,2,...n$$

4.1.4.2 确定参考数据列

参考数据列应该是一个理想的比较标准，可以以各指标的最优值（或最劣值）构成参考数据列，也可根据评价目的选择其它参照值．记作 
$$
X_0^{‘} = （ x^{'}_0(1)，  x^{'}_0(2)，.....，  x^{'}_0(m)）
$$
4.1.4.3 确定被评价对象与参考列的绝对差值

也即
$$
|x_0(k)-x_i(k)|(k=1,2,....m;i=1,2,....n,n为被评价对象的个数)
$$
4.1.4.4 确定最小及最大值
$$
\min\limits_{i=1}^{n}\min\limits_{k=1}^{m}  {|x_0(k)-x_i(k)|}\\
\max\limits_{i=1}^{n} \max\limits_{k=1}^{m} {|x_0(k)-x_i(k)|}
$$
4.1.4.5 计算比较列与参考列对应元素的关联系数
$$
ζ_i(k) = \frac{\min\limits_{i=1}^{n}\min\limits_{k=1}^{m}  {|x_0^{'}(k)-x_i^{'}(k)|}+ρ·\max\limits_{i=1}^{n} \max\limits_{k=1}^{m} {|x_0^{'}(k)-x_i^{'}(k)|}}{|x_0^{'}(k)-x_i^{'}(k)|+ρ·\max\limits_{i=1}^{n} \max\limits_{k=1}^{m} {|x_0^{'}(k)-x_i^{'}(k)|}}
$$
其中 $$ρ$$为分辨系数，$$0<ρ<1$$。若$$ρ$$越小，关联系数间差异越大，区分能力越强。通常$$ρ$$取$$0.5$$ 

4.1.4.6计算关联序

对各评价对象（比较序列）分别计算其个指标与参考序列对应元素的关联系数的均值，以反映各评价对象与参考序列的关联关系，并称其为关联序，记为： 
$$
r_{0i} = \frac{1}{m}\sum\limits_{k=1}^{m}ζ_i(k)
$$
4.1.4.7 对关联系数求加权均值

对关联系数求加权均值也即：
$$
r^{'}_{0i} =\frac{1}{m}\sum\limits_{k=1}^{m}W_k·ζ_i(k)
$$
其中$$W_k​$$为各指标的权重。



## 5.整体模型

在基于改进的SIS模型上，我们以H值作为衡量该地区的药品滥用程度，以H值的增长率h作为衡量该地区的受扩散程度。通过熵权法我们可以求出I和F对应的权值，为0.73和30.63。则：

H=0.73*I+30.63*F

从而求出各个县的2010年-2017年对应的H值和H值相较于前一年的增长率。将五个州的各个县的H值借助python作出热点图，颜色越高说明该地区药物滥用越严重。

对于未来的相关预测，由于县的数量过多，并且非相邻的县之间也可能有一定的影响，所以我们简化为以每个县的地理位置为自变量，也即以经度和纬度作为自变量。又由于第二年的毒品事件数量受前一年的影响，因此前一年的毒品事件数量作为因变量。并且由于自变量与因变量之间存在于时间上的非线性关系，所以我们选择使用BP神经网络，通过对历史数据的训练，来预测H值和H值的增长率的变化趋势，同时基于BP神经网络求值的特点，也很好了避免线性规划带来的不准确性。

5.1 第一部分问题的解决

通过数据我们可以得知，多个药物事件发生数量较多的县的药物滥用事件数量达到某个值后，由较高开始降低，例如2014年和2015年的图像如下所示：

![1548590650321](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1548590650321.png)

​                                                                                          2014年

![1548590272615](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\1548590272615.png)

​                                                                                         2015年​                                                                

其中由数据可知，Nanticoke以及其他县都有达到一定较高值后开始减少的情形，查阅数据可得知这些数据，取这些数据的均值，求得为201.3，以该值为阈值，则当H大于201.3时则建议政府对该地区施行相关措施来遏制药物的滥用。

通过BP神经网络可以求得2018年的预测情况如下图所示：



因此需要警告...州...县需要进行药物滥用的管控。



并将五个州的各个县的H值的增长率借助python作出热点图，颜色越高的说明受扩散的影响越严重，从而可以从图中看出哪些地区是正在扩散的区域，哪些地区是扩散的发起点。图像如下所示：



通过数据我们可以得知当h大于87.6时，周边的地区的H值都有不同程度的增加。因此我们设置87.6为阈值，当h>87.6时，说明该地区正在被药物滥用进行扩散，需要建议政府实施相应措施防止其扩散。

通过BP神经网络可以求得2018年的预测情况如下图所示：



因此需要警告...州...县需要进行药物扩散的预防。





5.2 第二部分问题的解决

通过对第二部分数据的分析，我们可以得知总共有十多种政治经济因素，但是每年所调查的因素种类不全相同。因此为了使得对相关趋势的分析更加科学，我们只取每一年调查相同的因素，通过分析可知共有12种相同。由于数据中有一些数值是有损失或者是无法得到的，因此我们对数据进行预处理和筛选后来得出可用的数据。

通过灰色关联分析法求这12种因素对H值以及h值的影响大小顺序。求得各个因素和H值的关联系数求加权均值如下：

0.76>0.64>0.53>0.49>0.23>0.22>0.18>0.17>0.14>0.12>0.11>0.07

同时各个因素和h值的关联系数求加权均值如下：

0.78>0.72>0.61>0.50>0.22>0.20>0.19>0.17>0.11>0.10>0.09>0.06

两种序列都有共同的特点：前四个系数明显大于后面八个系数的值，说明这些因素对H值或h值的影响相较于后面八个因素更大。因此只去两个序列的前四个因素加入模型中进行分析。通过数据我们可以得知，两个序列的前四个因素是相同的，分别为：。。。因此我们取系数最大的前四个因素加入模型。则将该四个因素也作为自变量，通过BP神经网络可以得到各地区的H值以及h值的预测值，通过python作出相应的热力图，如下所示：









